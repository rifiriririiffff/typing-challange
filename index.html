<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Typing Bomb Challenge</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Orbitron", sans-serif;
        background: radial-gradient(#0d0d0d, #000);
        color: #ff3d00;
        text-align: center;
        padding: 20px;
      }
      h1 {
        font-size: 2em;
        color: #ff6f00;
        text-shadow: 0 0 30px red;
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          text-shadow: 0 0 30px red;
        }
        50% {
          text-shadow: 0 0 10px orange;
        }
      }
      #gameArea {
        max-width: 700px;
        margin: auto;
        background: #111;
        padding: 20px;
        border: 3px solid #f44336;
        border-radius: 12px;
        box-shadow: 0 0 30px rgba(255, 0, 0, 0.9);
        position: relative;
      }
      #quote {
        font-size: 1.7em;
        margin: 20px 0;
        color: #ffffff;
      }
      textarea {
        width: 90%;
        height: 80px;
        font-size: 1.2em;
        padding: 10px;
        text-align: center;
        background: #000;
        border: 2px solid #ff3d00;
        border-radius: 8px;
        color: #ff5722;
      }
      .btn {
        margin: 10px 5px;
        padding: 12px 25px;
        font-size: 1em;
        border: none;
        border-radius: 5px;
        background-color: #f44336;
        color: #fff;
        cursor: pointer;
      }
      #bombTimer {
        margin: 10px;
        font-size: 2em;
        color: #f44336;
        text-shadow: 0 0 10px red;
        border: 2px solid #f44336;
        display: inline-block;
        padding: 10px 20px;
        border-radius: 12px;
        background-color: #000;
      }
      .floatText {
        position: absolute;
        font-size: 1.6em;
        font-weight: bold;
        animation: floatUp 1s ease-out forwards;
        left: 50%;
        transform: translateX(-50%);
        top: 60px;
      }
      .plus {
        color: lime;
        text-shadow: 0 0 10px lime;
      }
      .minus {
        color: red;
        text-shadow: 0 0 10px red;
      }
      @keyframes floatUp {
        0% {
          opacity: 1;
          transform: translateY(0);
        }
        100% {
          opacity: 0;
          transform: translateY(-60px);
        }
      }
      #scoreboard {
        margin-top: 30px;
        color: #fff;
      }
      #scoreList li {
        text-align: left;
        margin: 5px auto;
      }
      .success-score {
        color: lime;
      }
      .failed-score {
        color: red;
      }
    </style>
  </head>
  <body>
    <h1>üí£ TYPING BOMB MISSION</h1>
    <div id="gameArea">
      <audio id="startMusic" src="startaction.mp3" loop></audio>
      <audio id="successSound" src="success.mp3"></audio>
      <audio id="bombSound" src="bomb.mp3"></audio>
      <audio id="missionFailedSound" src="missionfailed.mp3"></audio>

      <div id="quote">Press Start!</div>
      <textarea id="input" disabled placeholder="Type here..."></textarea>
      <div id="bombTimer">üí£ Timer: 20s</div>

      <input type="text" id="playerName" placeholder="Enter your codename" />
      <button class="btn" id="startBtn">Start Mission</button>

      <div id="scoreboard">
        <h3>Top Agents</h3>
        <ul id="scoreList"></ul>
        <button class="btn" id="resetScoreBtn">Reset Leaderboard</button>
      </div>
    </div>

    <script>
      const input = document.getElementById("input");
      const quote = document.getElementById("quote");
      const bombTimer = document.getElementById("bombTimer");
      const startBtn = document.getElementById("startBtn");
      const playerName = document.getElementById("playerName");
      const scoreList = document.getElementById("scoreList");
      const resetScoreBtn = document.getElementById("resetScoreBtn");
      const startMusic = document.getElementById("startMusic");
      const successSound = document.getElementById("successSound");
      const bombSound = document.getElementById("bombSound");
      const missionFailedSound = document.getElementById("missionFailedSound");

      let currentWord = "",
        timeLeft = 20,
        timerInterval,
        gameActive = false,
        score = 0,
        missionSuccess = false;
      const usedWords = [],
        easyWords = [
          "cat",
          "dog",
          "box",
          "sun",
          "red",
          "run",
          "car",
          "man",
          "pen",
          "hat",
        ],
        mediumWords = [
          "agent",
          "spy",
          "bomb",
          "timer",
          "mission",
          "code",
          "laser",
          "intel",
          "target",
          "escape",
          "map",
          "safe",
          "file",
          "key",
          "alert",
          "track",
          "enemy",
          "decode",
          "brief",
          "vault",
        ],
        hardWords = [
          "surveillance",
          "decryption",
          "disguise",
          "detonate",
          "protocol",
          "cipher",
          "tactical",
          "infiltrate",
          "counterintelligence",
          "encrypted",
          "interception",
          "exfiltration",
        ];

      function getNewWord() {
        let wordPool;
        if (score < 5) wordPool = easyWords;
        else if (score < 10) wordPool = mediumWords;
        else wordPool = hardWords;

        let word;
        do {
          word = wordPool[Math.floor(Math.random() * wordPool.length)];
        } while (usedWords.includes(word));
        usedWords.push(word);
        return word;
      }

      function showNewWord() {
        currentWord = getNewWord();
        quote.textContent = currentWord;
        input.value = "";
        input.focus();
      }

      function updateBombTimer() {
        const emoji = timeLeft > 0 ? "üí£" : "üí•";
        bombTimer.textContent = `${emoji} Timer: ${Math.max(timeLeft, 0)}s`;
      }

      function showFloatText(text, type) {
        const float = document.createElement("div");
        float.className = `floatText ${type}`;
        float.innerText = text;
        document.getElementById("gameArea").appendChild(float);
        setTimeout(() => float.remove(), 1000);
      }

      function saveScore() {
        const name = playerName.value.trim() || "Agent";
        const scores = JSON.parse(localStorage.getItem("scores") || "[]");
        scores.push({ name, score, missionSuccess });
        scores.sort((a, b) => b.score - a.score);
        localStorage.setItem("scores", JSON.stringify(scores.slice(0, 5)));
        displayScores();
      }

      function displayScores() {
        const scores = JSON.parse(localStorage.getItem("scores") || "[]");
        scoreList.innerHTML = scores
          .map((s, i) => {
            const statusClass = s.missionSuccess
              ? "success-score"
              : "failed-score";
            const statusText = s.missionSuccess
              ? `‚úÖ SUCCESS - ${s.score} pts`
              : `‚ùå FAILED - ${s.score} pts`;
            return `<li class="${statusClass}">#${i + 1} ${
              s.name
            }: ${statusText}</li>`;
          })
          .join("");
      }

      function resetScores() {
        localStorage.removeItem("scores");
        displayScores();
      }

      function endGame(success = false) {
        gameActive = false;
        missionSuccess = success;
        clearInterval(timerInterval);
        input.disabled = true;
        if (success) {
          input.value = "MISSION SUCCESS ‚úÖ";
          successSound.play();
        } else {
          input.value = "MISSION FAILED";
          input.style.fontSize = "2.5em";
          bombSound.play();
          missionFailedSound.play();
        }
        updateBombTimer();
        startMusic.pause();
        startMusic.currentTime = 0;
        saveScore();
      }

      function startGame() {
        timeLeft = 20;
        score = 0;
        missionSuccess = false;
        usedWords.length = 0;
        input.disabled = false;
        input.value = "";
        input.style.fontSize = "1.2em";
        gameActive = true;
        showNewWord();
        updateBombTimer();
        startMusic.play();
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
          timeLeft--;
          updateBombTimer();
          if (timeLeft <= 0) endGame();
        }, 1000);
      }

      input.addEventListener("input", () => {
        if (!gameActive) return;
        const typed = input.value.trim();
        if (typed === currentWord) {
          timeLeft += 5;
          score++;
          showFloatText("+5s", "plus");
          updateBombTimer();
          if (timeLeft >= 40) endGame(true);
          else showNewWord();
        } else if (!currentWord.startsWith(typed)) {
          timeLeft -= 6;
          showFloatText("-6s", "minus");
          if (timeLeft <= 0) endGame();
          else {
            updateBombTimer();
            showNewWord();
          }
        }
      });

      startBtn.onclick = () => {
        successSound.pause();
        missionFailedSound.pause();
        bombSound.pause();
        successSound.currentTime = 0;
        missionFailedSound.currentTime = 0;
        bombSound.currentTime = 0;
        startMusic.currentTime = 0;
        startGame();
      };

      resetScoreBtn.onclick = resetScores;
      window.onload = displayScores;
    </script>
  </body>
</html>
