<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Typing Bomb Challenge</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Orbitron", sans-serif;
        background: radial-gradient(#000000, #1a1a1a);
        color: #ff3d00;
        text-align: center;
        padding: 20px;
      }
      h1 {
        font-size: 2em;
        color: #ff6f00;
        text-shadow: 0 0 30px red;
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          text-shadow: 0 0 30px red;
        }
        50% {
          text-shadow: 0 0 10px orange;
        }
      }
      #gameArea {
        max-width: 700px;
        margin: auto;
        background: #111;
        padding: 20px;
        border: 3px solid #f44336;
        border-radius: 12px;
        box-shadow: 0 0 30px rgba(255, 0, 0, 0.9);
        position: relative;
      }
      #quote {
        font-size: 1.7em;
        margin: 20px 0;
        color: #ffffff;
      }
      textarea {
        width: 90%;
        height: 80px;
        font-size: 1.2em;
        padding: 10px;
        text-align: center;
        background: #000;
        border: 2px solid #ff3d00;
        border-radius: 8px;
        color: #ff5722;
      }
      .btn {
        margin: 10px 5px;
        padding: 12px 25px;
        font-size: 1em;
        border: none;
        border-radius: 5px;
        background-color: #f44336;
        color: #fff;
        cursor: pointer;
      }
      #bombTimer {
        margin: 10px;
        font-size: 2em;
        color: #f44336;
        text-shadow: 0 0 10px red;
        border: 2px solid #f44336;
        display: inline-block;
        padding: 10px 20px;
        border-radius: 12px;
        background-color: #000;
      }
      .shake {
        animation: shake 0.5s ease-in-out;
      }
      @keyframes shake {
        0%,
        100% {
          transform: translate(0, 0);
        }
        25% {
          transform: translate(-5px, 5px);
        }
        50% {
          transform: translate(5px, -5px);
        }
        75% {
          transform: translate(-5px, 5px);
        }
      }
      #scoreboard {
        margin-top: 60px;
        padding-top: 20px;
        border-top: 2px solid #ff6f00;
        color: #fff;
      }
      .floatSignal {
        position: absolute;
        font-size: 1.4em;
        font-weight: bold;
        animation: floatUp 1s ease-out forwards;
        left: 50%;
        transform: translateX(-50%);
        top: 100px;
        pointer-events: none;
      }
      .plus {
        color: lime;
        text-shadow: 0 0 10px lime;
      }
      .minus {
        color: red;
        text-shadow: 0 0 10px red;
      }
      @keyframes floatUp {
        0% {
          opacity: 1;
          transform: translateY(0);
        }
        100% {
          opacity: 0;
          transform: translateY(-50px);
        }
      }
      #statusLight {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        margin: 10px auto 0;
        background-color: #888;
        box-shadow: 0 0 10px #888;
      }
      #wrongWordsContainer {
        margin-top: 20px;
        color: #fff;
      }
      #wrongWordsContainer ul {
        list-style: square;
        padding-left: 30px;
        text-align: left;
        display: inline-block;
      }
    </style>
  </head>
  <body>
    <h1>💣 TYPING BOMB MISSION</h1>
    <div id="statusLight"></div>
    <div id="gameArea">
      <audio id="startMusic" src="startaction.mp3" loop></audio>
      <audio id="tickSound" src="tick.mp3" loop></audio>
      <audio id="bombSound" src="bomb.mp3"></audio>
      <audio id="missionFailedSound" src="missionfailed.mp3"></audio>
      <audio id="successSound" src="success.mp3"></audio>

      <div id="quote">Press Start!</div>
      <textarea id="input" disabled placeholder="Type here..."></textarea>
      <div
        id="pressSpace"
        style="display: none; font-weight: bold; color: lime"
      >
        ✅ PRESS SPACE!!
      </div>
      <div id="bombTimer">💣 Timer: 20s</div>
      <div
        id="gameOverDisplay"
        style="
          font-size: 1.5em;
          font-weight: bold;
          color: red;
          margin-top: 10px;
        "
      ></div>
      <input type="text" id="playerName" placeholder="Enter your codename" />
      <button class="btn" id="startBtn">Start Mission</button>

      <div id="wrongWordsContainer">
        <h4>Incorrect Entries:</h4>
        <ul id="wrongWordsList"></ul>
      </div>
    </div>

    <div id="scoreboard">
      <h3>Top Agents</h3>
      <ul id="scoreList"></ul>
      <button class="btn" id="resetScoreBtn">Reset Leaderboard</button>
    </div>

    <script>
      const startBtn = document.getElementById("startBtn");
      const input = document.getElementById("input");
      const quote = document.getElementById("quote");
      const pressSpace = document.getElementById("pressSpace");
      const bombTimer = document.getElementById("bombTimer");
      const gameOverDisplay = document.getElementById("gameOverDisplay");
      const scoreList = document.getElementById("scoreList");
      const playerName = document.getElementById("playerName");
      const statusLight = document.getElementById("statusLight");
      const wrongWordsList = document.getElementById("wrongWordsList");

      const startMusic = document.getElementById("startMusic");
      const tickSound = document.getElementById("tickSound");
      const bombSound = document.getElementById("bombSound");
      const missionFailedSound = document.getElementById("missionFailedSound");
      const successSound = document.getElementById("successSound");

      let words = [
        "mission",
        "agent",
        "intel",
        "decode",
        "explosion",
        "safehouse",
        "exfiltrate",
        "surveillance",
        "detonation",
        "briefcase",
      ];
      let score = 0;
      let timer = 20;
      let timerInterval;
      let currentWord = "";
      let usedWords = [];
      let gameActive = false;
      let wrongWords = [];

      function getNewWord() {
        if (usedWords.length === words.length) usedWords = [];
        let word;
        do {
          word = words[Math.floor(Math.random() * words.length)];
        } while (usedWords.includes(word));
        usedWords.push(word);
        return word;
      }

      function showNewWord() {
        currentWord = getNewWord();
        quote.textContent = currentWord;
        input.value = "";
        pressSpace.style.display = "none";
        input.focus();
      }

      function updateTimerDisplay() {
        bombTimer.textContent = `💣 Timer: ${timer}s`;
      }

      function floatSignal(text, type) {
        const float = document.createElement("div");
        float.className = `floatSignal ${type}`;
        float.textContent = text;
        document.getElementById("gameArea").appendChild(float);
        setTimeout(() => float.remove(), 1000);
      }

      function triggerShake() {
        document.body.classList.add("shake");
        setTimeout(() => document.body.classList.remove("shake"), 500);
      }

      function setStatusLight(color) {
        statusLight.style.backgroundColor = color;
        statusLight.style.boxShadow = `0 0 15px ${color}`;
      }

      function endGame(success = false) {
        clearInterval(timerInterval);
        input.disabled = true;
        gameActive = false;
        tickSound.pause();
        startMusic.pause();
        if (success) {
          gameOverDisplay.innerText = "MISSION SUCCESS";
          successSound.play();
        } else {
          gameOverDisplay.innerText = "MISSION FAILED";
          triggerShake();
          bombSound.play();
          missionFailedSound.play();
        }
        saveScore(success);
      }

      function saveScore(success) {
        const name = playerName.value.trim() || "Agent";
        const scores = JSON.parse(localStorage.getItem("scores") || "[]");
        scores.push({ name, score, success });
        scores.sort((a, b) => b.score - a.score);
        localStorage.setItem("scores", JSON.stringify(scores.slice(0, 10)));
        displayScores();
      }

      function displayScores() {
        const scores = JSON.parse(localStorage.getItem("scores") || "[]");
        scoreList.innerHTML = scores
          .map(
            (s) =>
              `<li style="color: ${s.success ? "lime" : "red"}">${s.name}: ${
                s.score
              } (${s.success ? "Success" : "Failed"})</li>`
          )
          .join("");
      }

      function resetScores() {
        localStorage.removeItem("scores");
        displayScores();
      }

      function startGame() {
        score = 0;
        timer = 20;
        usedWords = [];
        wrongWords = [];
        wrongWordsList.innerHTML = "";
        input.disabled = false;
        gameOverDisplay.innerText = "";
        showNewWord();
        updateTimerDisplay();
        gameActive = true;
        startMusic.currentTime = 0;
        startMusic.play();
        tickSound.currentTime = 0;
        tickSound.play();
        timerInterval = setInterval(() => {
          timer--;
          updateTimerDisplay();
          if (timer <= 0) endGame(false);
        }, 1000);
      }

      input.addEventListener("input", () => {
        if (!gameActive) return;
        const typed = input.value.trim();
        pressSpace.style.display =
          typed.length === currentWord.length ? "block" : "none";
      });

      input.addEventListener("keydown", (e) => {
        if (!gameActive) return;
        if (e.code === "Space") {
          e.preventDefault();
          const typed = input.value.trim();
          if (typed === currentWord) {
            score++;
            timer = Math.min(100, timer + 5);
            floatSignal("+5s", "plus");
            setStatusLight("lime");
            showNewWord();
            updateTimerDisplay();
            if (timer >= 100) endGame(true);
          } else {
            wrongWords.push(`${typed} ❌ -> ${currentWord}`);
            const li = document.createElement("li");
            li.textContent = `${typed} ❌ -> ${currentWord}`;
            wrongWordsList.appendChild(li);
            timer -= 6;
            floatSignal("-6s", "minus");
            setStatusLight("red");
            triggerShake();
            showNewWord();
            updateTimerDisplay();
            if (timer <= 0) endGame(false);
          }
        }
      });

      startBtn.addEventListener("click", startGame);
      document.getElementById("resetScoreBtn").onclick = resetScores;
      window.onload = displayScores;
    </script>
  </body>
</html>
